# Project Guidelines & Source of Truth

This document serves as the primary reference for all agents and developers working on the Veit Helmer digital archive project.

## 1. Project Overview
The goal is to modernize the digital archive of filmmaker Veit Helmer, migrating from legacy HTML/Flash to a modern, static, bilingual website.

## 2. Tech Stack
- **Static Site Generator:** Eleventy (11ty) v3.1+ (JavaScript-based)
- **Styling:** Tailwind CSS v4 (Utility-first, PostCSS)
- **Templating:** Nunjucks (`.njk`)
- **Animations:** GSAP (GreenSock) for Flash-like transitions
- **Build Tooling:** npm/pnpm scripts
- **Deployment:** GitHub Pages (via Actions)

## 3. Architecture & Conventions

### 3.1 File Structure
- **Content:** Markdown with Frontmatter.
- **Languages:** Dual-language support (`de` / `en`).
- **Assets:** Optimized images and modern video formats (MP4, H.264).

### 3.2 Localization Strategy
- **File Naming:**
  - German: `index_de.md`
  - English: `index_en.md`
- **Location:** Both files reside in the same directory: `/content/films/[film-slug]/`.
- **Routing:** `/de/` and `/en/` prefixes. Auto-redirect based on browser language preferred.

## 4. Content Architecture

### 4.1 Frontmatter Schema
All film content files must strictly follow this schema to ensure 1:1 bilingual mapping without data loss.

**Core Fields (Required):**
| Field | Type | Description | Allowed Values |
| :--- | :--- | :--- | :--- |
| `title` | String | Official film title | - |
| `language` | String | `de` or `en` | - |
| `director` | String | Director's name | - |
| `release_year` | Integer | Year of release | - |
| `duration` | Integer | Runtime in minutes | - |
| `category` | String | Production type | `Feature`, `Short`, `Commercial`, `Documentary` |
| `poster_image` | String | Relative path | e.g., `poster.jpg` |
| `trailer_video` | String | Relative path | e.g., `trailer.mp4` |

**Extended Metadata (Recommended to prevent data loss):**
| Field | Type | Description | Example |
| :--- | :--- | :--- | :--- |
| `cast` | List<Object> | Actors and their roles | `- { name: "Max Mauff", role: "Anton" }` |
| `crew` | List<Object> | Crew members and roles | `- { name: "Ivan Shvedoff", role: "Co-Writer" }` |
| `release_date` | String | Precise premiere date | `"1999-12-31"` |
| `film_languages` | List<String> | Spoken languages | `["English", "Japanese"]` |
| `technical_specs` | List<String> | Technical details | `["35mm", "1:1.85", "Dolby Digital"]` |
| `awards` | List<String> | Accolades and prizes | `["Silver Bear", "Grand Prix"]` |

**Example:**
```yaml
---
title: "Absurdistan"
language: "en"
director: "Veit Helmer"
release_year: 2008
duration: 88
category: "Feature"
poster_image: "poster.jpg"
trailer_video: "trailer.mp4"
cast:
  - name: "Kristýna Malérová"
    role: "Aya"
  - name: "Max Mauff"
    role: "Temelko"
crew:
  - name: "Gherman Golubchik"
    role: "Director of Photography"
technical_specs:
  - "35mm"
  - "Color"
---
```

## 5. Bilingual Mapping Verification (Task 1.3.2)
The schema and architecture have been verified for 1:1 bilingual mapping:
- **Logic:** Each film directory `/content/films/[slug]/` contains `index_de.md` and `index_en.md`.
- **Data Retention:** Structured fields (Frontmatter) handle cross-language metadata, while the Markdown body captures rich narrative data (Production Notes, Stories) from legacy sites.
- **Refinements:** Cast and Crew are structured as objects to preserve role-person mappings found in legacy archives. Precise dates and film-specific languages are supported via extended fields.

## 6. Development Workflows

### 5.1 Flash Reconstruction
Legacy Flash sites must be visually preserved but technically rebuilt.
1.  **Decompile:** Use JPEXS to extract assets (Images, SVG shapes).
2.  **Reference:** Use Ruffle or Internet Archive to study original animations/interactions.
3.  **Implement:** Rebuild using HTML5, CSS Grid/Flexbox, and GSAP.

### 5.2 Media Processing
- **Video:** Convert all legacy `.flv` files to H.264 MP4.
  - Command: `ffmpeg -i input.flv -c:v libx264 -crf 23 -c:a aac output.mp4`
- **Images:** Use `eleventy-img` for responsive sizing and formats (WebP/AVIF).

## 6. Design System
- **Theme:** Minimalist. **Black background (#000000)**, **White text (#FFFFFF)**.
- **Typography:** Sans-serif, clean.
- **Layout:**
  - **Homepage:** "Streaming Service" grid style. Grouped by category.
  - **Detail Pages:** Hero image, metadata list, external links.

## 7. Operational Rules
- **Do NOT** use Client-Side Routing (SPA) unless necessary for specific transitions. Prefer Multi-Page App (MPA) structure.
- **Do NOT** use heavy JS frameworks (React/Vue). Stick to vanilla JS + 11ty.
- **Do** optimize assets aggressively (lazy loading, blur-up).